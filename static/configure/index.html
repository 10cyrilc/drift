<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DRIFT - Configure</title>
    <link rel="stylesheet" href="/static/common.css" />
    <link rel="stylesheet" href="/static/configure/configure.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='80'>ðŸ”„</text></svg>"
    />
  </head>
  <body class="configure-page">
    <div class="container">
      <h1>DRIFT</h1>
      <form id="port-form" action="/configure" method="POST">
        <label for="port">Enter Backend Port:</label>
        <input
          type="number"
          id="port"
          name="port"
          placeholder="e.g. 3000"
          required
        />

        <div class="zrok-options">
          <h3>Zrok Tunnel Options</h3>

          <div class="option">
            <div class="radio-container">
              <input
                type="radio"
                id="zrok-auto"
                name="zrok_option"
                value="auto"
                checked
              />
              <label for="zrok-auto"
                >Automatic (use existing or create new)</label
              >
            </div>
            <span class="help-text"
              >Uses your existing reserved URL if available, or creates a new
              one</span
            >
          </div>

          <div class="option">
            <div class="radio-container">
              <input
                type="radio"
                id="zrok-custom"
                name="zrok_option"
                value="custom"
              />
              <label for="zrok-custom">Use specific reserved token</label>
            </div>
            <span class="help-text"
              >If you have a specific token you want to use, enter it here</span
            >

            <div class="token-inputs">
              <input
                type="text"
                id="zrok_token"
                name="zrok_token"
                placeholder="e.g. w1lowggzejo3"
                disabled
              />
              <input
                type="number"
                id="zrok_port"
                name="zrok_port"
                placeholder="Interceptor port (e.g. 4040)"
                disabled
              />
              <span class="help-text"
                >Enter the Interceptor port you used when creating this token
                (usually 4040)</span
              >
            </div>
          </div>
        </div>

        <button type="submit">Start Drifting</button>
      </form>
    </div>
    <script src="/static/common.js"></script>
    <script src="/static/configure/configure.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tokenInput = document.getElementById("zrok_token");
        const portInput = document.getElementById("zrok_port");
        const tokenInputs = document.querySelector(".token-inputs");
        const radioButtons = document.querySelectorAll(
          'input[name="zrok_option"]'
        );

        // Initially hide the token inputs
        tokenInputs.style.display = "none";

        radioButtons.forEach((radio) => {
          radio.addEventListener("change", () => {
            const isExisting = radio.value === "custom";
            tokenInput.disabled = !isExisting;
            portInput.disabled = !isExisting;
            tokenInputs.style.display = isExisting ? "block" : "none";

            if (isExisting) {
              tokenInput.focus();
            }
          });
        });
      });
    </script>
  </body>
</html>
